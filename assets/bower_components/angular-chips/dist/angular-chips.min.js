!function(){function e(e){return e&&angular.isFunction(e.then)}function n(e){return{add:function(n){var t=angular.copy(e.$modelValue)||[];t.push(n),e.$setViewValue(t)},"delete":function(n){var t=angular.copy(e.$modelValue);t.splice(n,1),e.$setViewValue(t)},deleteByValue:function(n){var t,i;for(t=0;t<e.$modelValue.length;t++)if(angular.equals(e.$modelValue[t],n)){i=t;break}void 0!==i&&this["delete"](i)}}}function t(e,n){var t=this;this.type="defer",this.defer=e,this.isLoading=!1,this.isFailed=!1,n&&(t.isLoading=!0,n.then(function(e){t.defer=e,t.isLoading=!1},function(e){t.defer=e,t.isLoading=!1,t.isFailed=!0}))}function i(e){if(void 0!==e){var n,t;return n=e.indexOf("(")+1,t=e.indexOf(")"),e.substr(n,t-n)}}function r(r,l,c){function a(l,a,u,s,d){function p(e){return function(n){return 37===n?e--:e++,e=e<0?l.chips.list.length-1:e>l.chips.list.length-1?0:e}}if(""!==(error=o(a)))throw error;var f=n(s),h=u.hasOwnProperty("defer"),m=i(u.render);l.chips.list,l.chips.addChip=function(n){function i(e){l.chips.list.push(e),f.add(e)}var r,o;return void 0!==l.render&&""!==m?(o={},o[m]=n,r=l.render(o)):r=n,!!r&&(e(r)?(r.then(function(e){f.add(e)}),l.chips.list.push(new t(n,r)),l.$apply()):i(r),!0)},l.chips.deleteChip=function(e){var n=l.chips.list.splice(e,1)[0];return n.isFailed?void l.$apply():void(n instanceof t?f.deleteByValue(n.defer):f["delete"](e))},s.$render=function(){if(h&&s.$modelValue){var e,n=[];for(e=0;e<s.$modelValue.length;e++)n.push(new t(s.$modelValue[e]));l.chips.list=n}else l.chips.list=angular.copy(s.$modelValue)||[]};var v=null,g=angular.element("<div></div>"),C=a.html();C=C.substr(C.indexOf("<chip-tmpl"),C.indexOf("</chip-tmpl>")-"</chip-tmpl>".length),a.find("chip-tmpl").remove();var $=angular.element(C);$.attr("ng-repeat","chip in chips.list track by $index"),$.attr("ng-class","{'chip-failed':chip.isFailed}"),$.attr("tabindex","-1"),$.attr("index","{{$index+1}}"),g.append($);var y=r(g)(l);a.prepend(y),a.on("click",function(e){"CHIPS"===e.target.nodeName&&a.find("input")[0].focus()}),a.find("input").on("focus",function(){v=null}),l.chips.handleKeyDown=function(e){function n(){var n=parseInt(document.activeElement.getAttribute("index"))||(t=a.find("chip-tmpl")).length;t=a.find("chip-tmpl"),t[n-1].focus(),v=p(n-1),"INPUT"!==e.target.nodeName&&t[v(e.keyCode)].focus()}if(!("INPUT"!==e.target.nodeName&&"CHIP-TMPL"!==e.target.nodeName||0===a.find("chip-tmpl").length&&""===e.target.value)){var t;if(8===e.keyCode){if("INPUT"===e.target.nodeName&&""===e.target.value)n(),e.preventDefault();else if("CHIP-TMPL"===e.target.nodeName){var i=a.find("chip-tmpl");i.length>0&&parseInt(e.target.getAttribute("index"))-1===i.length&&a.find("chip-tmpl")[v(37)].focus()}}else 37!==e.keyCode&&39!==e.keyCode||(null===v?n():a.find("chip-tmpl")[v(e.keyCode)].focus())}},a.on("keydown",l.chips.handleKeyDown),c(a).addClass("chip-out-focus")}return a.$inject=["scope","iElement","iAttrs","ngModelCtrl","transcludefn"],{restrict:"E",scope:{render:"&?"},transclude:!0,require:"ngModel",link:a,controller:"chipsController",controllerAs:"chips",template:"<div ng-transclude></div>"}}function o(e){return 0===e.find("chip-tmpl").length?"should have chip-tmpl":e.find("chip-tmpl").length>1?"should have only one chip-tmpl":""}function l(e,n,t){this.setFocus=function(e){e?t(n).removeClass("chip-out-focus").addClass("chip-in-focus"):t(n).removeClass("chip-in-focus").addClass("chip-out-focus")},this.removeChip=function(e,n){this.deleteChip(n)}}r.$inject=["$compile","$timeout","DomUtil"],l.$inject=["$scope","$element","DomUtil"],angular.module("angular.chips",[]).directive("chips",r).controller("chipsController",l)}(),function(){function e(){return{restrict:"E",transclude:!0,link:function(e,n,t,i,r){r(e,function(e){n.append(e)}),n.on("keydown",function(n){8===n.keyCode&&(e.$broadcast("chip:delete"),n.preventDefault())})}}}angular.module("angular.chips").directive("chipTmpl",e)}(),function(){function e(){return{restrict:"A",require:"^?chips",link:function(e,n,t,i){function r(e,n){var t;if(n.search("\\(")>0&&(n=n.substr(0,n.search("\\("))),void 0!==n)if(n.split(".").length>1){var i=n.split(".");t=e;for(var r=0;r<i.length;r++)t=t[i[r]]}else t=e[n];return t}function o(e,n){var t=n.indexOf(".")!==-1?n.split(".")[0]:n.split("(")[0];return e.hasOwnProperty(t)?e:o(e.$parent,n)}function l(){if("string"==typeof e.chip||!e.chip.isLoading){var n,l=!0;t.hasOwnProperty("removeChip")&&""!==t.removeChip&&(n=r(o(e,t.removeChip),t.removeChip),l=n(e.chip)),l&&i.removeChip(e.chip,e.$index)}}n.on("click",function(){l()}),e.$on("chip:delete",function(){l()})}}}angular.module("angular.chips").directive("removeChip",e)}(),function(){function e(e){var n={};return n.addClass=function(t){return n.removeClass(e,t),e.attr("class",e.attr("class")+" "+t),n},n.removeClass=function(t){var i=e.attr("class").split(" "),r=i.indexOf(t);return r!==-1&&i.splice(r,1),e.attr("class",i.join(" ")),n},n}angular.module("angular.chips").factory("DomUtil",function(){return e})}(),function(){function e(){return{restrict:"A",require:"^chips",link:n}}function n(e,n,t,i){n.on("keypress",function(e){13===e.keyCode&&(""!==e.target.value&&i.addChip(e.target.value)&&(e.target.value=""),e.preventDefault())}),n.on("focus",function(){i.setFocus(!0)}),n.on("blur",function(){i.setFocus(!1)})}n.$inject=["scope","iElement","iAttrs","chipsCtrl"],angular.module("angular.chips").directive("chipControl",e)}(),function(){function e(){return{restrict:"A",require:["ngModel","^chips"],link:function(e,n,t,i){var r=i[0],o=i[1];r.$render=function(e){r.$modelValue&&o.addChip(r.$modelValue)&&n.val("")},n.on("focus",function(){o.setFocus(!0)}),n.on("blur",function(){o.setFocus(!1)})}}}angular.module("angular.chips").directive("ngModelControl",e)}();